<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="My personal digital garden"><meta name=author content=Lyz><link href=https://lyz-code.github.io/blue-book/devops/kubernetes/kubernetes_architecture/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.3"><title>Kubernetes architecture - The Blue Book</title><link rel=stylesheet href=../../../assets/stylesheets/main.edf004c2.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../css/timeago.css><link rel=stylesheet href=../../../stylesheets/extra.css><link rel=stylesheet href=../../../stylesheets/links.css><script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#master-nodes class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> For updates subscribe to the <a href=https://lyz-code.github.io/blue-book/newsletter/0_newsletter_index/ ><strong>RSS feed</strong></a> <img src=/blue-book/img/orange_logo.png height=15 width=15> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="The Blue Book" class="md-header__button md-logo" aria-label="The Blue Book" data-md-component=logo> <img src=../../../img/logo.bmp alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The Blue Book </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Kubernetes architecture </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/lyz-code/blue-book/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> lyz-code/blue-book </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="The Blue Book" class="md-nav__button md-logo" aria-label="The Blue Book" data-md-component=logo> <img src=../../../img/logo.bmp alt=logo> </a> The Blue Book </label> <div class=md-nav__source> <a href=https://github.com/lyz-code/blue-book/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> lyz-code/blue-book </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../projects/projects/ class=md-nav__link> Projects </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Activism <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Activism data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Activism </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_1 type=checkbox id=__nav_3_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../antifascism/ >Antifascism</a> </div> <nav class=md-nav aria-label=Antifascism data-md-level=2> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Antifascism </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../antitransphobia/ class=md-nav__link> Anti-Transphobia </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../diversity/ >Diversity, Equity and Inclusion</a> </div> <nav class=md-nav aria-label="Diversity, Equity and Inclusion" data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Diversity, Equity and Inclusion </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Feminism <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Feminism data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Feminism </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../feminism/privileges/ class=md-nav__link> Privileges </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../free_knowledge/ class=md-nav__link> Free Knowledge </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../life_management/ >Life Management</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Life Management" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Life Management </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Health <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Health data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Health </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../sleep/ class=md-nav__link> Sleep </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_2 type=checkbox id=__nav_5_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../teeth/ >Teeth</a> </div> <nav class=md-nav aria-label=Teeth data-md-level=2> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Teeth </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../remote_work/ class=md-nav__link> Remote Working </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5_4 type=checkbox id=__nav_5_4> <div class="md-nav__link md-nav__link--index "> <a href=../../../fitness_band/ >Fitness Tracker</a> </div> <nav class=md-nav aria-label="Fitness Tracker" data-md-level=2> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Fitness Tracker </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> Coding <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Coding data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_1 type=checkbox id=__nav_6_1> <label class=md-nav__link for=__nav_6_1> Generic Coding Practices <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Generic Coding Practices" data-md-level=2> <label class=md-nav__title for=__nav_6_1> <span class="md-nav__icon md-icon"></span> Generic Coding Practices </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_1_1 type=checkbox id=__nav_6_1_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../versioning/ >Program Versioning</a> <label for=__nav_6_1_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Program Versioning" data-md-level=3> <label class=md-nav__title for=__nav_6_1_1> <span class="md-nav__icon md-icon"></span> Program Versioning </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../changelog/ class=md-nav__link> Keep a Changelog </a> </li> <li class=md-nav__item> <a href=../../../documentation/ class=md-nav__link> Writing good documentation </a> </li> <li class=md-nav__item> <a href=../../../coding/tdd/ class=md-nav__link> TDD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_2 type=checkbox id=__nav_6_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../python/ >Python</a> <label for=__nav_6_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Python data-md-level=2> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../coding/json/json/ class=md-nav__link> JSON </a> </li> <li class=md-nav__item> <a href=../../../coding/sql/sql/ class=md-nav__link> SQL </a> </li> <li class=md-nav__item> <a href=../../../sqlite/ class=md-nav__link> SQLite </a> </li> <li class=md-nav__item> <a href=../../../coding/yaml/yaml/ class=md-nav__link> YAML </a> </li> <li class=md-nav__item> <a href=../../../coding/promql/promql/ class=md-nav__link> Promql </a> </li> <li class=md-nav__item> <a href=../../../vuejs/ class=md-nav__link> Vue.js </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6_9 type=checkbox id=__nav_6_9> <div class="md-nav__link md-nav__link--index "> <a href=../../../coding/javascript/javascript/ >Javascript</a> </div> <nav class=md-nav aria-label=Javascript data-md-level=2> <label class=md-nav__title for=__nav_6_9> <span class="md-nav__icon md-icon"></span> Javascript </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../coding/react/react/ class=md-nav__link> React </a> </li> <li class=md-nav__item> <a href=../../../issues/ class=md-nav__link> Issues </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../devops/ >DevOps</a> <label for=__nav_7> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=DevOps data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> DevOps </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> Software Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Software Architecture" data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Software Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../architecture/solid/ class=md-nav__link> SOLID </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8_2 type=checkbox id=__nav_8_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../architecture/domain_driven_design/ >Domain Driven Design</a> <label for=__nav_8_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="Domain Driven Design" data-md-level=2> <label class=md-nav__title for=__nav_8_2> <span class="md-nav__icon md-icon"></span> Domain Driven Design </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../adr/ class=md-nav__link> Architecture Decision Record </a> </li> <li class=md-nav__item> <a href=../../../architecture/database_architecture/ class=md-nav__link> Database Architecture </a> </li> <li class=md-nav__item> <a href=../../../architecture/orm_builder_query_or_raw_sql/ class=md-nav__link> ORM, Query Builder or Raw SQL </a> </li> <li class=md-nav__item> <a href=../../../architecture/microservices/ class=md-nav__link> Microservices </a> </li> <li class=md-nav__item> <a href=../../../architecture/restful_apis/ class=md-nav__link> Restful APIS </a> </li> <li class=md-nav__item> <a href=../../../architecture/redis/ class=md-nav__link> Redis </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9> Data Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Data Analysis" data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Data Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../data_analysis/recommender_systems/recommender_systems/ class=md-nav__link> Recommender Systems </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10 type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10> Operative Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operative Systems" data-md-level=1> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Operative Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10_1 type=checkbox id=__nav_10_1> <label class=md-nav__link for=__nav_10_1> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=__nav_10_1> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux_snippets/ class=md-nav__link> Linux Snippets </a> </li> <li class=md-nav__item> <a href=../../../afew/ class=md-nav__link> afew </a> </li> <li class=md-nav__item> <a href=../../../alot/ class=md-nav__link> alot </a> </li> <li class=md-nav__item> <a href=../../../activitywatch/ class=md-nav__link> ActivityWatch </a> </li> <li class=md-nav__item> <a href=../../../beancount/ class=md-nav__link> beancount </a> </li> <li class=md-nav__item> <a href=../../../beets/ class=md-nav__link> Beets </a> </li> <li class=md-nav__item> <a href=../../../linux/brew/ class=md-nav__link> brew </a> </li> <li class=md-nav__item> <a href=../../../docker/ class=md-nav__link> Docker </a> </li> <li class=md-nav__item> <a href=../../../dunst/ class=md-nav__link> dunst </a> </li> <li class=md-nav__item> <a href=../../../self_hosted/dynamicdns/ class=md-nav__link> Dynamic DNS </a> </li> <li class=md-nav__item> <a href=../../../linux/elasticsearch/ class=md-nav__link> elasticsearch </a> </li> <li class=md-nav__item> <a href=../../../linux/fail2ban/ class=md-nav__link> fail2ban </a> </li> <li class=md-nav__item> <a href=../../../gajim/ class=md-nav__link> Gajim </a> </li> <li class=md-nav__item> <a href=../../../gh/ class=md-nav__link> Github cli </a> </li> <li class=md-nav__item> <a href=../../../linux/google_chrome/ class=md-nav__link> google chrome </a> </li> <li class=md-nav__item> <a href=../../../graylog/ class=md-nav__link> Graylog </a> </li> <li class=md-nav__item> <a href=../../../linux/haproxy/ class=md-nav__link> HAProxy </a> </li> <li class=md-nav__item> <a href=../../../docs/linux/hard_drive_health.md class=md-nav__link> Hard drive health </a> </li> <li class=md-nav__item> <a href=../../../husboard/ class=md-nav__link> Hushboard </a> </li> <li class=md-nav__item> <a href=../../../linux/hypothesis/ class=md-nav__link> hypothesis </a> </li> <li class=md-nav__item> <a href=../../../jellyfin/ class=md-nav__link> Jellyfin </a> </li> <li class=md-nav__item> <a href=../../../ffmpeg/ class=md-nav__link> ffmpeg </a> </li> <li class=md-nav__item> <a href=../../../kitty/ class=md-nav__link> Kitty </a> </li> <li class=md-nav__item> <a href=../../../linux/luks/luks/ class=md-nav__link> LUKS </a> </li> <li class=md-nav__item> <a href=../../../mbsync/ class=md-nav__link> mbsync </a> </li> <li class=md-nav__item> <a href=../../../linux/mkdocs/ class=md-nav__link> mkdocs </a> </li> <li class=md-nav__item> <a href=../../../modipy.md class=md-nav__link> Modipy </a> </li> <li class=md-nav__item> <a href=../../../linux/monica/ class=md-nav__link> monica </a> </li> <li class=md-nav__item> <a href=../../../notmuch/ class=md-nav__link> notmuch </a> </li> <li class=md-nav__item> <a href=../../../linux/nodejs/ class=md-nav__link> nodejs </a> </li> <li class=md-nav__item> <a href=../../../oracle_database/ class=md-nav__link> Oracle Database </a> </li> <li class=md-nav__item> <a href=../../../peek/ class=md-nav__link> Peek </a> </li> <li class=md-nav__item> <a href=../../../linux/rm/ class=md-nav__link> rm </a> </li> <li class=md-nav__item> <a href=../../../linux/syncthing/ class=md-nav__link> Syncthing </a> </li> <li class=md-nav__item> <a href=../../../tahoe/ class=md-nav__link> Tahoe-LAFS </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10_1_36 type=checkbox id=__nav_10_1_36> <div class="md-nav__link md-nav__link--index "> <a href=../../../vim/ >Vim</a> <label for=__nav_10_1_36> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Vim data-md-level=3> <label class=md-nav__title for=__nav_10_1_36> <span class="md-nav__icon md-icon"></span> Vim </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../wake_on_lan/ class=md-nav__link> Wake on Lan </a> </li> <li class=md-nav__item> <a href=../../../linux/wireguard/ class=md-nav__link> Wireguard </a> </li> <li class=md-nav__item> <a href=../../../linux/zfs/ class=md-nav__link> ZFS </a> </li> <li class=md-nav__item> <a href=../../../linux/zip/ class=md-nav__link> zip </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10_2 type=checkbox id=__nav_10_2> <label class=md-nav__link for=__nav_10_2> Android <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Android data-md-level=2> <label class=md-nav__title for=__nav_10_2> <span class="md-nav__icon md-icon"></span> Android </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cone/ class=md-nav__link> cone </a> </li> <li class=md-nav__item> <a href=../../../gadgetbridge/ class=md-nav__link> GadgetBridge </a> </li> <li class=md-nav__item> <a href=../../../osmand/ class=md-nav__link> OsmAnd </a> </li> <li class=md-nav__item> <a href=../../../signal/ class=md-nav__link> Signal </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11 type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11> Arts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Arts data-md-level=1> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Arts </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_1 type=checkbox id=__nav_11_1> <div class="md-nav__link md-nav__link--index "> <a href=../../../writing/writing/ >Writing</a> <label for=__nav_11_1> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Writing data-md-level=2> <label class=md-nav__title for=__nav_11_1> <span class="md-nav__icon md-icon"></span> Writing </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_2 type=checkbox id=__nav_11_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../cooking/ >Cooking</a> </div> <nav class=md-nav aria-label=Cooking data-md-level=2> <label class=md-nav__title for=__nav_11_2> <span class="md-nav__icon md-icon"></span> Cooking </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../pilates/ class=md-nav__link> Pilates </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_4 type=checkbox id=__nav_11_4> <label class=md-nav__link for=__nav_11_4> Dancing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Dancing data-md-level=2> <label class=md-nav__title for=__nav_11_4> <span class="md-nav__icon md-icon"></span> Dancing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../dancing/rave_dances/ class=md-nav__link> Rave Dances </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_4_2 type=checkbox id=__nav_11_4_2> <label class=md-nav__link for=__nav_11_4_2> Shuffle <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shuffle data-md-level=3> <label class=md-nav__title for=__nav_11_4_2> <span class="md-nav__icon md-icon"></span> Shuffle </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../dancing/shuffle_basics/ class=md-nav__link> Basics </a> </li> <li class=md-nav__item> <a href=../../../dancing/shuffle_kicks/ class=md-nav__link> Kicks </a> </li> <li class=md-nav__item> <a href=../../../dancing/shuffle_spins/ class=md-nav__link> Spins </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../dancing/cutting_shapes_basics/ class=md-nav__link> Cutting Shapes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../meditation/ class=md-nav__link> Meditation </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_6 type=checkbox id=__nav_11_6> <label class=md-nav__link for=__nav_11_6> Video Gaming <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Video Gaming" data-md-level=2> <label class=md-nav__title for=__nav_11_6> <span class="md-nav__icon md-icon"></span> Video Gaming </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_6_1 type=checkbox id=__nav_11_6_1> <label class=md-nav__link for=__nav_11_6_1> The Battle for Wesnoth <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="The Battle for Wesnoth" data-md-level=3> <label class=md-nav__title for=__nav_11_6_1> <span class="md-nav__icon md-icon"></span> The Battle for Wesnoth </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../wesnoth/ class=md-nav__link> The Battle for Wesnoth </a> </li> <li class=md-nav__item> <a href=../../../wesnoth_loyalist/ class=md-nav__link> Loyalist </a> </li> <li class=md-nav__item> <a href=../../../wesnoth_rebels/ class=md-nav__link> Rebels </a> </li> <li class=md-nav__item> <a href=../../../wesnoth_northerners/ class=md-nav__link> Northeners </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_7 type=checkbox id=__nav_11_7> <label class=md-nav__link for=__nav_11_7> Board Gaming <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Board Gaming" data-md-level=2> <label class=md-nav__title for=__nav_11_7> <span class="md-nav__icon md-icon"></span> Board Gaming </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../regicide/ class=md-nav__link> Regicide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_11_8 type=checkbox id=__nav_11_8> <div class="md-nav__link md-nav__link--index "> <a href=../../../drawing/drawing/ >Drawing</a> </div> <nav class=md-nav aria-label=Drawing data-md-level=2> <label class=md-nav__title for=__nav_11_8> <span class="md-nav__icon md-icon"></span> Drawing </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../origami/ class=md-nav__link> Origami </a> </li> <li class=md-nav__item> <a href=../../../fun/ class=md-nav__link> Fun </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_12 type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12> Psychology <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Psychology data-md-level=1> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Psychology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../psychology/the_xy_problem/ class=md-nav__link> The XY Problem </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_13 type=checkbox id=__nav_13> <label class=md-nav__link for=__nav_13> Botany <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Botany data-md-level=1> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> Botany </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../botany/trees/ class=md-nav__link> Trees </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../emojis/ class=md-nav__link> Emojis </a> </li> <li class=md-nav__item> <a href=../../../contact/ class=md-nav__link> Contact </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_16 type=checkbox id=__nav_16> <div class="md-nav__link md-nav__link--index "> <a href=../../../newsletter/0_newsletter_index/ >Newsletters</a> <label for=__nav_16> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Newsletters data-md-level=1> <label class=md-nav__title for=__nav_16> <span class="md-nav__icon md-icon"></span> Newsletters </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#master-nodes class=md-nav__link> Master Nodes </a> </li> <li class=md-nav__item> <a href=#worker-nodes class=md-nav__link> Worker Nodes </a> <nav class=md-nav aria-label="Worker Nodes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kube-proxy-operation-modes class=md-nav__link> kube-proxy operation modes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kubectl class=md-nav__link> Kubectl </a> </li> <li class=md-nav__item> <a href=#number-of-clusters class=md-nav__link> Number of clusters </a> <nav class=md-nav aria-label="Number of clusters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#one-large-shared-cluster class=md-nav__link> One Large shared cluster </a> </li> <li class=md-nav__item> <a href=#cluster-per-environment class=md-nav__link> Cluster per environment </a> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> Conclusion </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> References </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/lyz-code/blue-book/edit/master/docs/devops/kubernetes/kubernetes_architecture.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>Architecture</h1> <p><a href=../kubernetes/ >Kubernetes</a> is a <a href=https://kubernetes.io/docs/concepts/overview/components/ >combination of components</a> distributed between two kind of nodes, <a href=#master-nodes>Masters</a> and <a href=#worker-nodes>Workers</a>.</p> <p><img alt="kubernetes core architecture diagram" src=../../../img/k8s.core.architecture.png></p> <h2 id=master-nodes>Master Nodes<a class=headerlink href=#master-nodes title="Permanent link">⚑</a></h2> <p>Master nodes or Kubernetes Control Plane are the controlling unit for the cluster. They manage scheduling of new containers, configure networking and provide health information.</p> <p>To do so it uses:</p> <ul> <li> <p><a href=https://kubernetes.io/docs/concepts/overview/components/#kube-apiserver>kube-api-server</a> exposes the Kubernetes control plane API validating and configuring data for the different API objects. It's used by all the components to interact between themselves.</p> </li> <li> <p><a href=https://en.wikipedia.org/wiki/Container_Linux#ETCD>etcd</a> is a "Distributed reliable key-value store for the most critical data of a distributed system". Kubernetes uses Etcd to store state about the cluster and service discovery between nodes. This state includes what nodes exist in the cluster, which nodes they are running on and what containers should be running.</p> </li> <li> <p><a href=https://kubernetes.io/docs/concepts/overview/components/#kube-scheduler>kube-scheduler</a> watches for newly created pods with no assigned node, and selects a node for them to run on.</p> <p>Factors taken into account for scheduling decisions include individual and collective resource requirements, hardware/software/policy constraints, affinity and anti-affinity specifications, data locality, inter-workload interference and deadlines.</p> </li> <li> <p><a href=https://kubernetes.io/docs/concepts/overview/components/#kube-controller-manager>kube-controller-manager</a> runs the following controllers:</p> <ul> <li><em>Node Controller</em>: Responsible for noticing and responding when nodes go down.</li> <li><em>Replication Controller</em>: Responsible for maintaining the correct number of pods for every replication controller object in the system.</li> <li><em>Endpoints Controller</em>: Populates the Endpoints object (that is, joins Services &amp; Pods).</li> <li><em>Service Account &amp; Token Controllers</em>: Create default accounts and API access tokens for new namespaces.</li> </ul> </li> <li> <p><a href=https://kubernetes.io/docs/concepts/overview/components/#cloud-controller-manager>cloud-controller-manager</a> runs controllers that interact with the underlying cloud providers.</p> <ul> <li><em>Node Controller</em>: For checking the cloud provider to determine if a node has been deleted in the cloud after it stops responding.</li> <li><em>Route Controller</em>: For setting up routes in the underlying cloud infrastructure.</li> <li><em>Service Controller</em>: For creating, updating and deleting cloud provider load balancers.</li> <li><em>Volume Controller</em>: For creating, attaching, and mounting volumes, and interacting with the cloud provider to orchestrate volumes.</li> </ul> </li> </ul> <h2 id=worker-nodes>Worker Nodes<a class=headerlink href=#worker-nodes title="Permanent link">⚑</a></h2> <p>Worker nodes are the units that hold the application data of the cluster. There can be different types of nodes: CPU architecture, amount of resources (CPU, RAM, GPU) or cloud provider.</p> <p>Each node has the services necessary to run pods:</p> <ul> <li><a href=https://kubernetes.io/docs/concepts/overview/components/#container-runtime>Container Runtime</a>: The software responsible for running containers (Docker, rkt, containerd, CRI-O).</li> <li><a href=https://kubernetes.io/docs/admin/kubelet/ >kubelet</a>: The primary “node agent”. It works in terms of a PodSpec (a YAML or JSON object that describes it). <code>kubelet</code> takes a set of PodSpecs from the masters <code>kube-api-server</code> and ensures that the containers described are running and healthy.</li> <li> <p><a href=https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/ >kube-proxy</a> is the network proxy that runs on each node. This reflects services as defined in the Kubernetes API on each node and can do simple TCP and UDP stream forwarding or round robin across a set of backends.</p> <p><code>kube-proxy</code> maintains network rules on nodes. These network rules allow network communication to your Pods from network sessions inside or outside of your cluster.</p> <p><code>kube-proxy</code> uses the operating system packet filtering layer if there is one and it's available. Otherwise, it will forward the traffic itself.</p> </li> </ul> <h3 id=kube-proxy-operation-modes>kube-proxy operation modes<a class=headerlink href=#kube-proxy-operation-modes title="Permanent link">⚑</a></h3> <p><code>kube-proxy</code> currently supports three different operation modes:</p> <ul> <li><em>User space</em>: This mode gets its name because the service routing takes place in kube-proxy in the user process space instead of in the kernel network stack. It is not commonly used as it is slow and outdated.</li> <li><em>iptables</em>: This mode uses Linux kernel-level Netfilter rules to configure all routing for Kubernetes Services. This mode is the default for kube-proxy on most platforms. When load balancing for multiple backend pods, it uses unweighted round-robin scheduling.</li> <li><em>IPVS (IP Virtual Server)</em>: Built on the Netfilter framework, IPVS implements Layer-4 load balancing in the Linux kernel, supporting multiple load-balancing algorithms, including least connections and shortest expected delay. This kube-proxy mode became generally available in Kubernetes 1.11, but it requires the Linux kernel to have the IPVS modules loaded. It is also not as widely supported by various Kubernetes networking projects as the iptables mode.</li> </ul> <h2 id=kubectl>Kubectl<a class=headerlink href=#kubectl title="Permanent link">⚑</a></h2> <p>The <em>kubectl</em> is the command line client used to communicate with the Masters.</p> <h2 id=number-of-clusters><a href=https://learnk8s.io/how-many-clusters>Number of clusters</a><a class=headerlink href=#number-of-clusters title="Permanent link">⚑</a></h2> <p>You can run a given set of workloads either on few large clusters (with many workloads in each cluster) or on many clusters (with few workloads in each cluster).</p> <p>Here's a table that summarizes the pros and cons of various approaches:</p> <p><img alt=" " src=../../../img/number_k8s_clusters.svg> <em>Figure: Possibilities of number of clusters from <a href=https://learnk8s.io/how-many-clusters>learnk8s.io article</a></em></p> <p>Reference to the <a href=https://learnk8s.io/how-many-clusters>original article</a> for a full read (it's really good!). I'm going to analyze only the <em>Large shared cluster</em> and <em>Cluster per environment</em> options, as they are the closest to my use case.</p> <h3 id=one-large-shared-cluster>One Large shared cluster<a class=headerlink href=#one-large-shared-cluster title="Permanent link">⚑</a></h3> <p>With this option, you run all your workloads in the same cluster. Kubernetes provides namespaces to logically separate portions of a cluster from each other, and in the above case, you could use a separate namespace for each application instance.</p> <p>Pros:</p> <ul> <li> <p><em>Efficient resource usage</em>: You need to have only one copy of all the resources that are needed to run and manage a Kubernetes cluster (master nodes, load balancers, Ingress controllers, authentication, logging, and monitoring).</p> </li> <li> <p><em>Cheap</em>: As you avoid the duplication of resources, you require less hardware.</p> </li> <li> <p><em>Efficient administration</em>: Administering a Kubernetes cluster requires:</p> <ul> <li>Upgrading the Kubernetes version</li> <li>Setting up a CI/CD pipeline</li> <li>Installing a CNI plugin</li> <li>Setting up the user authentication system</li> <li>Installing an admission controller</li> </ul> <p>If you have only a single cluster, you need to do all of this only once.</p> <p>If you have many clusters, then you need to apply everything multiple times, which probably requires you to develop some automated processes and tools for being able to do this consistently.</p> </li> </ul> <p>Cons:</p> <ul> <li> <p><em>Single point of failure</em>: If you have only one cluster and if that cluster breaks, then all your workloads are down.</p> <p>There are many ways that something can go wrong:</p> <ul> <li>A Kubernetes upgrade produces unexpected side effects.</li> <li>An cluster-wide component (such as a CNI plugin) doesn't work as expected.</li> <li>An erroneous configuration is made to one of the cluster components.</li> <li>An outage occurs in the underlying infrastructure.</li> </ul> <p>A single incident like this can produce major damage across all your workloads if you have only a single shared cluster.</p> </li> <li> <p><em>No hard security isolation</em>: If multiple apps run in the same Kubernetes cluster, this means that these apps share the hardware, network, and operating system on the nodes of the cluster.</p> <p>Concretely, two containers of two different apps running on the same node are technically two processes running on the same hardware and operating system kernel.</p> <p>Linux containers provide some form of isolation, but this isolation is not as strong as the one provided by, for example, virtual machines (VMs). Under the hood, a process in a container is still just a process running on the host's operating system.</p> <p>This may be an issue from a security point of view — it theoretically allows unrelated apps to interact with each other in undesired ways (intentionally and unintentionally).</p> <p>Furthermore, all the workloads in a Kubernetes cluster share certain cluster-wide services, such as DNS — this allows apps to discover the Services of other apps in the cluster.</p> <p>It's important to keep in mind that Kubernetes is designed for sharing, and not for isolation and security.</p> </li> <li> <p><em>No hard multi-tenancy</em>: Given the many shared resources in a Kubernetes cluster, there are many ways that different apps can "step on each other's toes".</p> <p>For example, an app may monopolize a certain shared resource, such as the CPU or memory, and thus starve other apps running on the same node.</p> <p>Kubernetes provides various ways to control this behaviour, however it's not trivial to tweak these tools in exactly the right way, and they cannot prevent every unwanted side effect either.</p> </li> <li> <p><em>Many users</em>: If you have only a single cluster, then many people in your organisation must have access to this cluster.</p> <p>The more people have access to a system, the higher the risk that they break something.</p> <p>Within the cluster, you can control who can do what with role-based access control (RBAC) — however, this still can't prevent that users break something within their area of authorisation.</p> </li> </ul> <h3 id=cluster-per-environment>Cluster per environment<a class=headerlink href=#cluster-per-environment title="Permanent link">⚑</a></h3> <p>With this option you have a separate cluster for each environment.</p> <p>For example, you can have a <code>dev</code>, <code>test</code>, and <code>prod</code> cluster where you run all the application instances of a specific environment.</p> <ul> <li> <p><em>Isolation of the *prod</em> environment*: In general, this approach isolates all the environments from each other — but, in practice, this especially matters for the prod environment.</p> <p>The production versions of your app are now not affected by whatever happens in any of the other clusters and application environments.</p> <p>So, if some misconfiguration creates havoc in your dev cluster, the prod versions of your apps keep running as if nothing had happened.</p> </li> <li> <p><em>Cluster can be customised for an environment</em>:</p> <p>You can optimise each cluster for its environment — for example, you can:</p> <pre><code>* Install development and debugging tools in the dev cluster.
* Install testing frameworks and tools in the test cluster.
* Use more powerful hardware and network connections for the prod
cluster.
</code></pre> <p>This may improve the efficiency of both the development and operation of your apps. * <em>Lock down access to prod cluster</em>: Nobody really needs to do work on the prod cluster, so you can make access to it very restrictive.</p> </li> </ul> <p>Cons:</p> <ul> <li> <p><em>More administration and resources</em>: In comparison with the single cluster.</p> </li> <li> <p><em>Lack of isolation between apps</em>: The main disadvantage of this approach is the missing hardware and resource isolation between apps.</p> <p>Unrelated apps share cluster resources, such as the operating system kernel, CPU, memory, and several other services.</p> <p>As already mentioned, this may be a security issue.</p> </li> <li> <p><em>App requirements are not localised</em>: If an app has special requirements, then these requirements must be satisfied in all clusters.</p> </li> </ul> <h3 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">⚑</a></h3> <p>If you don't need environment isolation and are not afraid of upgrading the Kubernetes cluster, go for the single cluster, otherwise use a cluster per environment.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">⚑</a></h2> <ul> <li><a href=https://kubernetes.io/docs/concepts/overview/components/ >Kubernetes components overview</a></li> </ul> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2021-08-06T16:41:41+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2021-08-06</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../kubernetes/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Kubernetes" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Kubernetes </div> </div> </a> <a href=../kubernetes_namespaces/ class="md-footer__link md-footer__link--next" aria-label="Next: Namespaces" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Namespaces </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/lyz-code target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://lyz-code.github.io/blue-book/newsletter/0_newsletter_index target=_blank rel=noopener title=lyz-code.github.io class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.instant", "navigation.top", "content.code.annotate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script> <script src=../../../assets/javascripts/bundle.e1a181d9.min.js></script> <script src=../../../js/timeago.min.js></script> <script src=../../../js/timeago_mkdocs_material.js></script> </body> </html>